---
title: "CapDAP_exploratory_analysis"
author: "Marliese"
date: "11/9/2022"
output: html_document
---

First lets set things up
```{r}
rm(list = ls())
library(tidyverse)
library(here)
library(ggfortify)
library(readr)
```

Now let's pull in the data
```{r}
DF <- read.csv(here("Data", "CapDAP_data.csv"),stringsAsFactors = TRUE)
```

Before we begin any analysis, we need to check our data for possible errors/outliers.


## We'd like to ask the following questions from these data:

### 1. Is there a relationship between Watershed (and therefore burn policy) and species composition?


A. Watershed names
```{r}
levels(DF$Watershed)
```

Initially, SpB and SPB look to me to be the same, and after looking at the metadata I am confident they are. So I am going to fix that really quick before moving on.


```{r}
fix <- which(DF$Watershed == "SPB")
DF$Watershed[fix]<-"SpB"
```

R still thinks there are 9 levels. Lets relevel them by making Watershed a factor variable again.
```{r}
DF$Watershed <-factor(DF$Watershed)
levels(DF$Watershed)
```


B. Let's check Watershed and Species

Histogram for Watershed
```{r}
ggplot(DF, aes(x = Watershed))+
     geom_histogram(stat="count")
```


Histogram for Species
```{r}
ggplot(DF, aes(x = Species),stat="count")+
     geom_histogram(stat="count")
```


Let's run a summary on all the variables
```{r}
summary(DF)
```

Both Watershed and Species are catagorical nominal variables.

***This was the test I wanted to ask Erika about so I am going to stop here with this one and move on to the next analysis.


### 2. Is there a relationship between Watershed (and therefore burn policy) and the weight of the animal (and maybe the length of the animal if I have time)?


Begin by checking the data. We've already looked at Watershed how about weight?

```{r}
summary(DF$Weight)
```
***there are too many points to see an outlier. Go back into Stats notes and remember how to use head() function to see however many lowest and highest values you would like.


Let's view a histogram.
```{r}
ggplot(DF, aes(x = Weight))+
     geom_histogram(stat="count")
```

***I think it would possibly be beneficial to me to choose one species and ask if the weights of that species change between Watersheds. But I will ask Erika and just continue on with this now.


I should plot the data. My x variable is categorical, y is continuous. A boxplot would be a good choice here.

```{r}
ggplot(DF, aes(Watershed, Weight))+
     geom_boxplot()+
     geom_point(size = 2, alpha = 0.5, position = "jitter")
```

Oh boy. Okay, based on this plot I am pretty definite that I should narrow down to one species. Looking at this plot though, you can see different trends. In 20B there is a clump around the middle, in 1D and 4F there are clumps closer to the bottom, and R1A is spread pretty evenly with points at high middle and lower values.


This looks like a one-way ANOVA because there are more than 2 levels of my categorical variable and because my response variable is continuous.

Build the model
```{r}
Wt_mod <- lm(Weight ~ Watershed, data = DF)
```
***it ran the model successfully, but gives me a warning.

Now we need to check the assumptions 

```{r}
autoplot(Wt_mod, smooth.color = NA)
```
I think this would look more reasonable if I chose one species, but as is I think it is okay.

So now let's look at the results of our model and do some interpretation.

```{r}
anova(Wt_mod)
```
This gives me an error.

Let's look at the summary

```{r}
summary(Wt_mod)
```

***This gives me an error too. I will have to come back and see what I can do.


### 3. Is there a relationship between Species and Year?

A. I want to check levels for Species

```{r}
levels(DF$Species)
```
Okay that looks good.


B. Let's check Species and Year

Histogram for Species
```{r}
ggplot(DF, aes(x = Species))+
     geom_histogram(stat="count")
```

Now check year
```{r}
ggplot(DF, aes(x = RecYear))+
     geom_histogram()
```

Both variables are continuous

Make a scatterplot
#### Plot relationship
```{r}
ggplot(DF, aes(x = RecYear,  y = Species, color = Watershed))+
     geom_point()+
     theme_bw()
```
***I am confused on how to interpret this. What is my estimated slope and y-intercept?

My response is quantitative continuous and my explanatory is categorical nominal so simple linear regression seems appropriate.

Linear regression model
```{r}
Yr_mod <- lm(Species ~ RecYear, data = DF)
```
***I think I need to go over this with Erika because maybe I am using the wrong tests.

I need to check model assumptions before interpreting.

```{r}
autoplot(Yr_mod)
```

Based on my observations of the autoplot results, I am not comfortable that my data mean the lm() assumptions.


Now look at model outcome
```{r}
anova(Yr_mod)
```
```{r}
summary(Yr_mod)
```


Figure to show relationship

```{r}
ggplot(DF, aes(RecYear, Species))+
     geom_point()+
     geom_smooth(method = "lm")+
     ylab("Species")+
     theme_bw()
```





